const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MazSpinner-DfHwN_9D-PgxqxJNs.js","assets/index-ykSPm2dP.js","assets/index-CrjI0VQQ.css","assets/MazSpinner-TKBjL_aI.css"])))=>i.map(i=>d[i]);
import{G as A,d as b,b as m,H as f,s as g,o as d,c as h,F as I,I as y,a as C,m as E,f as O,B as L,q as P,n as B,E as w,v as S,_ as u}from"./index-ykSPm2dP.js";var z=Object.defineProperty,H=(a,s,t)=>s in a?z(a,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[s]=t,n=(a,s,t)=>H(a,typeof s!="symbol"?s+"":s,t);const _="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",k={baseClass:"m-lazy-img",loadedClass:"m-lazy-loaded",loadingClass:"m-lazy-loading",errorClass:"m-lazy-error",noPhotoClass:"m-lazy-no-photo",noPhoto:!1,observerOnce:!0,loadOnce:!1,noUseErrorPhoto:!1,observerOptions:{threshold:.1}};class U{constructor(s={}){n(this,"observers",[]),n(this,"defaultOptions",k),n(this,"options"),n(this,"onImgLoadedCallback"),n(this,"onImgErrorCallback"),n(this,"hasImgLoaded",!1),this.options=this.buildOptions(s),this.onImgLoadedCallback=this.imageIsLoaded.bind(this),this.onImgErrorCallback=this.imageHasError.bind(this)}async loadErrorPhoto(){const{default:s}=await u(async()=>{const{default:t}=await import("./no-photography-BJX8HSus-CQMntAsz.js");return{default:t}},[]);return s}buildOptions(s){return{...this.defaultOptions,...s,observerOptions:{...this.defaultOptions.observerOptions,...s.observerOptions}}}removeClass(s,t){s.classList.remove(t)}addClass(s,t){s.classList.add(t)}removeAllStateClasses(s){this.removeClass(s,this.options.loadedClass),this.removeClass(s,this.options.loadingClass),this.removeClass(s,this.options.errorClass),this.removeClass(s,this.options.noPhotoClass)}setBaseClass(s){this.addClass(s,this.options.baseClass)}imageIsLoading(s){var t,e;this.addClass(s,this.options.loadingClass),(e=(t=this.options).onLoading)==null||e.call(t,s)}imageHasNoPhoto(s){this.removeClass(s,this.options.loadingClass),this.addClass(s,this.options.noPhotoClass),this.setDefaultPhoto(s)}imageIsLoaded(s){var t,e;this.hasImgLoaded=!0,this.removeClass(s,this.options.loadingClass),this.addClass(s,this.options.loadedClass),(e=(t=this.options).onLoaded)==null||e.call(t,s)}imageHasError(s){var t,e;this.removeClass(s,this.options.loadingClass),this.addClass(s,this.options.errorClass),(e=(t=this.options).onError)==null||e.call(t,s),this.setDefaultPhoto(s)}getSrc(s){return typeof s.value=="object"?s.value.src:s.value}getImageUrl(s,t){return this.getImgElement(s).getAttribute("data-lazy-src")||this.getSrc(t)}async setPictureSourceUrls(s){const t=s.querySelectorAll("source");if(t.length>0)for await(const e of t){const r=e.getAttribute("data-lazy-srcset");if(r)e.srcset=r;else return this.imageHasError(s)}else this.imageHasError(s)}hasBgImgMode(s){return s.arg==="bg-image"}isPictureElement(s){return s instanceof HTMLPictureElement}getImgElement(s){return this.isPictureElement(s)?s.querySelector("img"):s}async setDefaultPhoto(s){if(this.options.noUseErrorPhoto)return;const t=this.options.fallbackSrc??this.options.errorPhoto;typeof t=="string"&&this.addClass(s,this.options.noPhotoClass);const e=t??await this.loadErrorPhoto(),r=s.querySelectorAll("source");if(r.length>0)for await(const o of r)o.srcset=e;else this.setImgSrc(s,e)}addEventListenerToImg(s){const t=this.getImgElement(s);t.addEventListener("load",()=>this.onImgLoadedCallback(s),{once:!0}),t.addEventListener("error",e=>this.onImgErrorCallback(s,e),{once:!0})}async loadImage(s,t){if(this.imageIsLoading(s),this.isPictureElement(s))this.addEventListenerToImg(s),await this.setPictureSourceUrls(s);else{const e=this.getImageUrl(s,t);if(!e)return this.imageHasError(s);this.hasBgImgMode(t)?(s.style.backgroundImage=`url('${e}')`,this.imageIsLoaded(s)):(this.addEventListenerToImg(s),this.setImgSrc(s,e))}}setImgSrc(s,t){const e=this.getImgElement(s);e.src=t}handleIntersectionObserver(s,t,e,r){var o,l;this.observers.push(r);for(const i of e)if(i.isIntersecting){if((l=(o=this.options).onIntersecting)==null||l.call(o,i.target),this.options.observerOnce&&r.unobserve(s),this.options.loadOnce&&this.hasImgLoaded)return;this.loadImage(s,t)}}createObserver(s,t){const e=(o,l)=>{this.handleIntersectionObserver(s,t,o,l)},r=this.options.observerOptions;new IntersectionObserver(e,r).observe(s)}async imageHandler(s,t,e){if(e==="update")for await(const r of this.observers)r.unobserve(s);window.IntersectionObserver?this.createObserver(s,t):this.loadImage(s,t)}async bindUpdateHandler(s,t,e){if(this.options.noPhoto)return this.imageHasNoPhoto(s);await this.imageHandler(s,t,e)}async add(s,t){if(this.hasBgImgMode(t)&&this.isPictureElement(s))throw new Error(`[MazLazyImg] You can't use the "bg-image" mode with "<picture />" element`);setTimeout(()=>this.setBaseClass(s),0),s.getAttribute("src")||this.setImgSrc(s,_),await this.bindUpdateHandler(s,t,"bind")}async update(s,t){t.value!==t.oldValue&&(this.hasImgLoaded=!1,this.removeAllStateClasses(s),await this.bindUpdateHandler(s,t,"update"))}remove(s,t){this.hasImgLoaded=!1,this.hasBgImgMode(t)&&(s.style.backgroundImage=""),this.removeAllStateClasses(s);for(const e of this.observers)e.unobserve(s);this.observers=[]}}let c;const D={created(a,s){const t=typeof s.value=="object"?s.value:{};c=new U(t),c.add(a,s)},updated(a,s){c.update(a,s)},unmounted(a,s){c.remove(a,s)}},M=["data-lazy-srcset","media"],T=["alt"],$={key:0,class:"m-lazy-img-component-loader"},N=b({inheritAttrs:!1,__name:"MazLazyImg",props:{style:{default:void 0},class:{default:void 0},image:{default:void 0},src:{default:void 0},alt:{default:void 0},noPhoto:{type:Boolean},noLoader:{type:Boolean},noObserverOnce:{type:Boolean},loadOnce:{type:Boolean},imageHeightFull:{type:Boolean},observerOptions:{default:void 0},fallbackSrc:{default:void 0}},emits:["intersecting","loading","loaded","error"],setup(a){const s=a,t=S(()=>u(()=>import("./MazSpinner-DfHwN_9D-PgxqxJNs.js"),__vite__mapDeps([0,1,2,3]))),e=m(()=>s.image||s.src),r=m(()=>{var o;return typeof e.value=="string"?[{srcset:e.value}]:(o=e.value)==null?void 0:o.sources});return(o,l)=>f((d(),h("picture",{class:B(["m-lazy-img-component",[{"--use-loader":!o.noLoader,"--height-full":o.imageHeightFull},s.class]]),style:w(o.style)},[(d(!0),h(I,null,y(r.value,({srcset:i,media:v},p)=>(d(),h("source",{key:p,"data-lazy-srcset":i,media:v},null,8,M))),128)),C("img",E(o.$attrs,{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",loading:"lazy",alt:o.alt}),null,16,T),o.noLoader?O("v-if",!0):(d(),h("div",$,[L(g(t),{size:"2em"})])),P(o.$slots,"default",{},void 0,!0)],6)),[[g(D),{noPhoto:o.noPhoto,loadOnce:o.loadOnce,observerOptions:o.observerOptions,fallbackSrc:o.fallbackSrc,observerOnce:!o.noObserverOnce,onIntersecting:i=>o.$emit("intersecting",i),onLoading:i=>o.$emit("loading",i),onLoaded:i=>o.$emit("loaded",i),onError:i=>o.$emit("error",i)}]])}}),V=A(N,[["__scopeId","data-v-1003b940"]]);export{V as default};
